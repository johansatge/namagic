!function(e,t){"use strict";var n={};n.models={},n.views={},n.controllers={},n.utils={},n.init=function(e){n.node=e,n.devMode=n.node.fs.existsSync(".dev")&&"1"===n.node.fs.readFileSync(".dev",{encoding:"utf8"}),n.utils.locale.init("undefined"!=typeof t.language?t.language:""),n.utils.menubar.init(),n.utils.menubar.on("new",i),n.utils.menubar.on("website",o),n.utils.menubar.on("help",s),n.utils.menubar.on("bug_report",r),n.utils.menubar.on("quit",a),i()},n.openDateFormatsHelp=function(){var e=new n.utils.windowbootstrap("templates/dateformats.min.html",{toolbar:!1,frame:!0,width:500,height:650,min_width:300,min_height:300,position:"mouse",resizable:!0,show:!1,title:n.utils.locale.get("dateformats.title")}),t=e.initAndShow();e.on("close",function(){t.close(!0)})};var i=function(){var e=new n.controllers.main;e.init()},o=function(){n.node.gui.Shell.openExternal(n.utils.locale.get("manifest.urls.website"))},s=function(){n.node.gui.Shell.openExternal(n.utils.locale.get("manifest.urls.help"))},r=function(){n.node.gui.Shell.openExternal(n.utils.locale.get("manifest.urls.bug_report"))},a=function(){n.node.gui.App.closeAllWindows()};e.App=n}(window,navigator),function(e){"use strict";var t=function(t){var n="string"==typeof t?t:e.node.util.inspect(t);process.stdout.write("\n"+n+"\n")};e.utils.log=t}(window.App),function(app){"use strict";var module={},strings={};module.init=function(language_code){language_code=_parseLanguageCode(language_code);var json;try{json=eval("("+app.node.fs.readFileSync("locale/"+language_code+".json")+")"),app.node.moment.locale(language_code)}catch(error){json=eval("("+app.node.fs.readFileSync("locale/en.json")+")"),app.node.moment.locale("en")}json.manifest=app.node.gui.App.manifest,_parseObject("",json)},module.get=function(e){return"undefined"!=typeof strings[e]?strings[e]:e},module.getAll=function(){return strings};var _parseObject=function(e,t){for(var n in t)"string"==typeof t[n]?strings[e+(""!==e?".":"")+n]=t[n]:_parseObject(e+(""!==e?".":"")+n,t[n])},_parseLanguageCode=function(e){return-1===e.search("-")?e:e.substring(0,e.indexOf("-"))};app.utils.locale=module}(window.App),function(e,t){"use strict";var n=function(n,i){var o,s=new e.node.events.EventEmitter;this.on=function(e,t){s.on(e,t)},this.initAndShow=function(){return o=e.node.gui.Window.open(n,i),o.on("close",t.proxy(a,this)),o.on("document-end",t.proxy(r,this)),o};var r=function(){o.window.onload=t.proxy(l,this)},a=function(){s.emit("close")},l=function(){p(o.window.document),o.menu=e.utils.menubar.get(),o.on("focus",function(){e.utils.windowmanager.setCurrentWindow(o)}),o.on("blur",function(){e.utils.windowmanager.setCurrentWindow(!1)}),e.devMode&&o.showDevTools(),o.show(),o.focus();var n=t(o.window.document.body);n.html(e.utils.template.render(n.html(),[e.utils.locale.getAll()])),s.emit("loaded",t(o.window),n)},p=function(e){var n=t(e);n.on("dragover drop",function(e){e.preventDefault(),e.stopPropagation()})}};e.utils.windowbootstrap=n}(window.App,jQuery),function(e,t){"use strict";var n={},i=!1;n.setCurrentWindow=function(e){i!==!1&&i.removeAllListeners("move"),i=e,i!==!1&&(i.on("move",t.proxy(o,this)),o())};var o=function(){var t=e.node.gui.Window.get();t.x=i.x,t.y=i.y};e.utils.windowmanager=n}(window.App,jQuery),function(e){"use strict";var t={};t.render=function(e,t,n){for(var i=0;i<t.length;i+=1)if("object"==typeof t[i])for(var o in t[i]){var s=new RegExp("{{"+o+"}}","g");e=e.replace(s,t[i][o])}return n?e.replace(/\{\{[\w_]+\}\}/g,""):e},e.utils.template=t}(window.App),function(e){"use strict";var t,n,i={};i.on=function(e,t){n.on(e,t)},i.init=function(){n=new e.node.events.EventEmitter,t=new e.node.gui.Menu({type:"menubar"}),t.createMacBuiltin(e.utils.locale.get("manifest.name")),t.items[0].submenu.removeAt(0),t.items[0].submenu.insert(new e.node.gui.MenuItem({label:e.utils.locale.get("manifest.name")+" "+e.utils.locale.get("manifest.version"),enabled:!1}),0),t.items[1].submenu.removeAt(0),t.items[1].submenu.removeAt(0),t.items[1].submenu.removeAt(0);var i=new e.node.gui.Menu;i.append(new e.node.gui.MenuItem({label:e.utils.locale.get("menu.new"),key:"n",modifiers:"cmd",click:function(){n.emit("new")}})),t.insert(new e.node.gui.MenuItem({label:e.utils.locale.get("menu.file"),submenu:i}),1);var o=new e.node.gui.Menu;o.append(new e.node.gui.MenuItem({label:e.utils.locale.get("menu.help.help"),key:"?",modifiers:"cmd",click:function(){n.emit("help")}})),o.append(new e.node.gui.MenuItem({type:"separator"})),o.append(new e.node.gui.MenuItem({label:e.utils.locale.get("menu.help.website"),click:function(){n.emit("website")}})),o.append(new e.node.gui.MenuItem({label:e.utils.locale.get("menu.help.bug_report"),click:function(){n.emit("bug_report")}})),t.insert(new e.node.gui.MenuItem({label:e.utils.locale.get("menu.help.title"),submenu:o}),4)},i.get=function(){return t},e.utils.menubar=i}(window.App),function(e,t){"use strict";var n={};n.inverseCase=function(e){for(var t="",n=0;n<e.length;n+=1)t+=e.charAt(n)===e.charAt(n).toLowerCase()?e.charAt(n).toUpperCase():e.charAt(n).toLowerCase();return t},n.quoteRegex=function(e){var t=new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g");return e.replace(t,"\\$&")},n.formatDate=function(t,n){var i=new Date(t);return e.node.moment(i).format(n)};e.utils.string=n}(window.App,jQuery),function(e){"use strict";var t={};t.toggleClass=function(e,t,n){var i=-1!==e.className.search(new RegExp("[ ^]"+t+'[ "]',"g"));n=void 0!==n?n:!i,n&&!i&&(e.className+=" "+t),n||(e.className=e.className.replace(new RegExp(t,"g"),""))},e.utils.dom=t}(window.App),function(e){"use strict";var t=function(){var t,n,i,o,s,r,a,l,p=new e.node.events.EventEmitter,c=[],u={},d=[],f=0,h=[];this.on=function(e,t){p.on(e,t)},this.cancelCurrentWork=function(){o=[],i=f,h=[]},this.hasFiles=function(){return f>0},this.dismissOverwriteFiles=function(e){for(var t=[],n=0;n<e.length;n+=1){var i=c[u[e[n]]];i.setError(!1,""),t.push(i)}p.emit("update_files",t)},this.getDefaultDestinationDir=function(){return r},this.addFiles=function(e){p.emit("progress",0),h=e,t=h.length,g.apply(this)};var g=function(){for(var n=h.splice(0,50),i=[],o=0;o<n.length;o+=1){var s=n[o],a=e.node.crypto.createHash("md5").update(s).digest("hex");if("undefined"==typeof u[a]){u[a]=c.length;var l=new e.models.file(a,s.substring(0,s.lastIndexOf("/")),s.substring(s.lastIndexOf("/")+1));i.push(l),c.push(l),f+=1}}"undefined"!=typeof l&&(r=l.getDirectory()),p.emit("add_files",i),p.emit("progress",h.length>0?100*(t-h.length)/t:100),h.length>0?setTimeout($.proxy(g,this),0):(p.emit("idle"),p.emit("added_files"))};this.applyOperationsOnFiles=function(e,t,r){if(p.emit("progress",0),"string"==typeof t&&(a=t),i=0,"object"==typeof e)o=e;else{o=[];for(var c in u)o.push(c)}n=0,s=[],l=r?!0:!1,m.apply(this)};var m=function(){var t=c[u[o[i]]];if(t.getError()===!1||t.getError().overwrites){if(!t.destinationExists(a)||l)return void t.applyUpdatedName(a,$.proxy(v,this));t.setError(!0,e.utils.locale.get("main.errors.file_exists"),!0)}v.apply(this,[t,!1])},v=function(e,t){if(n+=1,i+=1,t){var r=e.getID();s.push(r),c[u[r]]=!1,delete u[r],f-=1}else p.emit("update_files",[e]);p.emit("progress",i<o.length?100*n/o.length:100),i<o.length?m.apply(this):(p.emit("remove_files",s),p.emit("idle"))};this.removeFiles=function(e){for(var t=0;t<e.length;t+=1)c[u[e[t]]]=null,delete u[e[t]],f-=1;p.emit("remove_files",e)},this.storeOperations=function(e){d=e},this.processCurrentOperations=function(){var e=[],t=0;for(var n in u){var i=c[u[n]];i.processOperations(d,t,f)&&e.push(i),t+=1}p.emit("update_files",e)}};e.models.main=t}(window.App),function(e){"use strict";var t={};t.allText=function(e,t){return[{start:0,end:e.length}]},t.freeText=function(t,n){var i=[];if(""!==n.text)for(var o,s=new RegExp(e.utils.string.quoteRegex(n.text),n.caseInsensitive?"gi":"g");null!==(o=s.exec(t));)i.push({start:o.index,end:o.index+o[0].length});return i},t.charsList=function(t,n){var i=[];if(""!==n.customList&&i.push("["+e.utils.string.quoteRegex(n.customList)+"]+"),n.alphabeticChars&&i.push("[a-zA-Z]+"),n.digits&&i.push("[0-9]+"),n.specialChars&&i.push("[^a-zA-Z0-9]+"),0===i.length)return[];for(var o,s=new RegExp("("+i.join("|")+")","g"),r=[];null!==(o=s.exec(t));)r.push({start:o.index,end:o.index+o[0].length});return r},t.textPosition=function(e,t){var n=isNaN(parseInt(t.index))?!1:parseInt(t.index);if(n!==!1&&n>=0){var i=t.fromEnd?e.length-n:n;return[{start:i,end:i}]}return[]},t.textRange=function(e,t){var n=isNaN(parseInt(t.index))?!1:parseInt(t.index),i=isNaN(parseInt(t.length))?!1:parseInt(t.length);if(n!==!1&&n>=0&&i!==!1&&i>=0){var o=t.fromEnd?e.length-n-i:n;return[{start:o,end:o+i}]}return[]},t.regex=function(e,t){var n=!1,i=[];try{n=""!==t.regex?new RegExp(t.regex,(t.isGlobal?"g":"")+(t.caseInsensitive?"i":"")):!1}catch(o){n=!1}if(n!==!1)for(var s;null!==(s=n.exec(e))&&(i.push({start:s.index,end:s.index+s[0].length}),t.isGlobal););return i},e.models.selection=t}(window.App),function(e){"use strict";var t={};t.removeText=function(e,t,n,i,o){return{type:"replace",text:""}},t.freeText=function(e,t,n,i,o){return{type:"add",text:t.text}},t.digitsSequence=function(e,t,n,i,o){var s=isNaN(parseInt(t.startIndex))?0:parseInt(t.startIndex),r=isNaN(parseInt(t.step))?1:parseInt(t.step),a=s+n*r,l=s+i*r;return t.add_leading_zeros&&(a=new Array(l.toString().length-a.toString().length+1).join("0")+a),{type:"add",text:a}},t.updateCase=function(t,n,i,o,s){return"uppercase"===n.type&&(t=t.toUpperCase()),"lowercase"===n.type&&(t=t.toLowerCase()),"invert"===n.type&&(t=e.utils.string.inverseCase(t)),{type:"replace",text:t}},t.creationDate=function(t,i,o,s,r){var a=n.apply(this,[r,"birthtime"]);return a instanceof Error?a:{type:"add",text:e.utils.string.formatDate(a,i.format)}},t.lastModifiedDate=function(t,i,o,s,r){var a=n.apply(this,[r,"mtime"]);return a instanceof Error?a:{type:"add",text:e.utils.string.formatDate(a,i.format)}},t.fileSize=function(t,i,o,s,r){var a=n.apply(this,[r,"size"]);return a instanceof Error?a:{type:"add",text:e.node.filesize(a,{bits:!1,spacer:""})}};var n=function(t,n){try{var i=e.node.fs.statSync(t);return i[n]}catch(o){return new Error(e.utils.locale.get("main.errors.stat_not_found"))}};e.models.action=t}(window.App),function(e){"use strict";var t=function(t,n,i){var o,s=t,r=e.node.unorm.nfkc(i),a=n,l=!1,p=!1,c="",u="...";this.destinationExists=function(t){if(t===a)return!1;var n;try{e.node.fs.readFileSync(t+"/"+u),n=!0}catch(i){n=!1}return n},this.applyUpdatedName=function(t,n){o=n,e.node.fs.rename(a+"/"+r,t+"/"+u,$.proxy(d,this))};var d=function(e){e&&this.setError(!0,e.message),o(this,e?!1:!0)};this.processOperations=function(t,n,i){var o=u;this.setError(!1,""),u=r;for(var s=a+"/"+r,l=0;l<t.length;l+=1){var p=t[l];if(p.selection!==!1&&0!==p.actions.length){var c,d;-1!==u.indexOf(".")?(c=u.substring(0,u.lastIndexOf(".")),d=u.substring(u.lastIndexOf("."))):(c=u,d=""),"filename"===p.applyTo&&(u=f.apply(this,[c,p.selection,p.actions,n,i,s])+d),"extension"===p.applyTo&&(u=c+f.apply(this,[d,p.selection,p.actions,n,i,s])),"both"===p.applyTo&&(u=f.apply(this,[u,p.selection,p.actions,n,i,s]))}}return""===u&&this.setError(!0,e.utils.locale.get("main.errors.empty_filename")),u!==o};var f=function(t,n,i,o,s,r){for(var a=e.models.selection[n.type](t,n.options),l="",p=!1,c=!1,u=0;u<a.length;u+=1){c=a[u],l+=t.substring(p!==!1?p.end:0,c.start);for(var d=t.substring(c.start,c.end),f=0;f<i.length;f+=1){var h=e.models.action[i[f].type],g=h(d,i[f].options,o,s,r);g instanceof Error?(this.setError(!0,g.message),d=e.utils.locale.get("main.errors.error")):d="add"===g.type?d+g.text:g.text}l+=d,p=c}return c!==!1?l+t.substring(c.end):t};this.getID=function(){return s},this.getName=function(){return r},this.getUpdatedName=function(){return u},this.getDirectory=function(){return a},this.setError=function(e,t,n){l=e?!0:!1,p=n?!0:!1,c=t},this.getError=function(){return l?{message:c,overwrites:p}:!1}};e.models.file=t}(window.App),function(e,t){"use strict";var n=function(){this.files,this.operations;var n=null,i=new e.node.events.EventEmitter,o={};this.on=function(e,t){i.on(e,t)},this.show=function(){var i=new e.utils.windowbootstrap("templates/main.min.html",{toolbar:!1,frame:!0,width:900,height:600,min_width:750,min_height:450,position:"mouse",resizable:!0,show:!1,title:""});i.on("loaded",t.proxy(s,this)),i.on("close",t.proxy(p,this)),n=i.initAndShow()},this.close=function(){n.close(!0)};var s=function(e,t){r.apply(this,[e,t]),a.apply(this),l.apply(this),i.emit("loaded")},r=function(e,t){o.window=e,o.body=t,o.filesPanel=o.body.find(".js-files-panel"),o.operationsPanel=o.body.find(".js-operations-panel"),o.optionsPanel=o.body.find(".js-toolbar-panel")},a=function(){this.files=new e.views.files,this.files.init(o.window,o.filesPanel),this.operations=new e.views.operations,this.operations.init(o.operationsPanel)},l=function(){o.window.on("resize",t.proxy(c,this)).trigger("resize")},p=function(){i.emit("close")},c=function(){var e=o.window.width(),t=o.window.height(),n=o.optionsPanel.height();o.filesPanel.css({width:e-o.operationsPanel.width()-1+"px",height:t-n+"px"}),o.operationsPanel.css({height:t-n+"px"})}};e.views.main=n}(window.App,jQuery),function(e,t){"use strict";var n=function(){var n,i=new e.node.events.EventEmitter,o={},s=!1,r=!1,a={},l=0;this.on=function(e,t){i.on(e,t)},this.init=function(e,n){c.apply(this,[e,n]),o.cancelAsync.on("click",t.proxy(p,this)),o.filesInput.on("change",t.proxy(m,this)),o.destinationInput.on("change",t.proxy(y,this)),this.lockInterface(!1)},this.getDestinationDir=function(e){o.destinationInput.val("").attr("nwworkingdir",e).trigger("click")},this.lockInterface=function(e){o.add.attr("disabled",e?"disabled":null),o.remove.attr("disabled",e||0===o.list.children().filter(".js-active").length?"disabled":null),o.list.find(".js-overwrite-button").attr("disabled",e?"disabled":null),(e?o.window.off:o.window.on).apply(o.window,["keydown keyup",t.proxy(d,this)]),(e?o.panel.off:o.panel.on).apply(o.panel,["dragenter",t.proxy(f,this)]),(e?o.dragOverlay.off:o.dragOverlay.on).apply(o.dragOverlay,["dragleave",t.proxy(h,this)]),(e?o.panel.off:o.panel.on).apply(o.panel,["drop",t.proxy(g,this)]),(e?o.list.off:o.list.on).apply(o.list,["click",".js-file",t.proxy(x,this)]),(e?o.list.off:o.list.on).apply(o.list,["click",".js-overwrite-button",t.proxy(w,this)]),(e?o.add.off:o.add.on).apply(o.add,["click",t.proxy(v,this)]),(e?o.remove.off:o.remove.on).apply(o.remove,["click",t.proxy(b,this)])},this.removeFiles=function(e){for(var t=0;t<e.length;t+=1)a[e[t]].row.parentNode.removeChild(a[e[t]].row),delete a[e[t]],l-=1;r=!1,o.remove.attr("disabled","disabled"),o.placeholder.toggle(0===o.list.children().length),u.apply(this)},this.updateFiles=function(i,s){for(var r=0;r<i.length;r+=1){var p=i[r],c=p.getID(),d=p.getError();if(s){l+=1;var f=t(e.utils.template.render(n,[p]));o.list.append(f);var h=f.get(0);a[c]={row:h,updatedName:h.querySelector(".js-new-name"),error:h.querySelector(".js-error"),overwriteButtons:h.querySelector(".js-overwrite")},h.setAttribute("id",c),h.querySelector(".js-name").innerHTML=p.getName()}a[c].updatedName.innerHTML=p.getUpdatedName(),a[c].error.style.display=d!==!1?"block":"none",a[c].error.innerHTML=d!==!1?d.message:"",a[c].overwriteButtons.style.display=d!==!1&&d.overwrites?"block":"none"}u.apply(this)},this.setProgress=function(e){o.progressBarProgress.css({width:e+"%"}),0===e&&(o.add.hide(),o.remove.hide(),o.filesCount.hide(),o.progressBarProgress.css({width:0}),o.progressbar.show()),100===e&&(o.add.show(),o.remove.show(),o.filesCount.show(),o.progressbar.hide(),o.placeholder.toggle(0===o.list.children().length))};var p=function(){i.emit("cancel")},c=function(e,t){o.window=e,o.panel=t,o.cancelAsync=t.find(".js-cancel"),o.dragOverlay=t.find(".js-drag-overlay"),o.placeholder=t.find(".js-placeholder"),o.filesInput=t.find(".js-files-input"),o.destinationInput=t.find(".js-dest-input"),o.add=t.find(".js-files-add"),o.remove=t.find(".js-files-remove"),o.list=t.find(".js-files-list"),o.progressbar=t.find(".js-progressbar"),o.progressBarProgress=t.find(".js-progressbar-progress"),o.filesCount=t.find(".js-files-count"),n=t.find(".js-file-template").html(),u.apply(this)},u=function(){var t,n,i=o.list.children().filter(".js-active").length;0===i?(n="main.toolbar.count."+(1>=l?"one":"many"),t=e.utils.locale.get(n).replace("$1",l)):(n="main.toolbar.count.selected_"+(1>=i?"one":"many"),t=e.utils.locale.get(n).replace("$1",i).replace("$2",l)),o.filesCount.html(t)},d=function(e){(16===e.which||91===e.which)&&(s="keydown"===e.type?e.which:!1),8===e.which&&"keyup"===e.type&&b.apply(this)},f=function(){o.dragOverlay.stop().fadeIn(150)},h=function(){o.dragOverlay.stop().fadeOut(150)},g=function(e){h(),i.emit("add_files",j.apply(this,[e.originalEvent.dataTransfer.files]))},m=function(e){i.emit("add_files",j.apply(this,[e.target.files]))},v=function(e){e.preventDefault(),o.filesInput.trigger("click")},y=function(e){e.preventDefault();var t=e.target.files.length>0?e.target.files[0].path:!1;i.emit("set_destination",t)},w=function(e){var n=t(e.currentTarget);e.preventDefault(),e.stopPropagation();var s=n.data("type"),r=[];if(n.data("target")){var a=o.list.find(".js-overwrite:visible").closest(".js-file");a.each(function(){r.push(t(this).attr("id"))})}else r.push(n.closest(".js-file").attr("id"));i.emit("overwrite",s,r)},x=function(e){var n=t(e.currentTarget);if(16===s)if(r===!1)n.toggleClass("js-active");else{var i=Math.min(r.index(),n.index()),a=Math.max(r.index(),n.index());o.list.children().slice(i,a+1).addClass("js-active")}else n.toggleClass("js-active"),91!==s&&n.siblings().removeClass("js-active");r=n.hasClass("js-active")?n:!1,o.remove.attr("disabled",n.hasClass("js-active")?!1:"disabled"),u.apply(this)},b=function(){var e=o.list.children().filter(".js-active"),n=[];e.each(function(){n.push(t(this).attr("id"))}),i.emit("remove_files",n)},j=function(e){var t=[];for(var n in e)"undefined"!=typeof e[n].path&&""!==e[n].path&&t.push(e[n].path);return t}};e.views.files=n}(window.App,jQuery),function(e,t){"use strict";var n=function(){var n,i=new e.node.events.EventEmitter,o={},s={};this.on=function(e,t){i.on(e,t)},this.init=function(e){r.apply(this,[e]),a.apply(this)},this.lockInterface=function(e){o.add.attr("disabled",e?"disabled":null),o.apply.attr("disabled",e?"disabled":null),o.operations.find("input,select,button").attr("disabled",e?"disabled":null),o.operations.sortable(e?"disable":"enable"),o.operations.find(".js-actions").sortable(e?"disable":"enable"),o.panel.toggleClass("js-disabled",e)};var r=function(e){o.panel=e,o.placeholder=e.find(".js-placeholder"),o.add=e.find(".js-operation-add"),o.apply=e.find(".js-operation-apply"),o.operations=e.find(".js-operations"),n=e.find(".js-operation-template").html(),e.find(".js-action-template").each(function(){var e=t(this);s[e.attr("rel")]=e.html()})},a=function(){o.add.on("click",t.proxy(h,this)),o.apply.on("click",t.proxy(m,this)),o.operations.sortable({items:".js-operation",axis:"y",placeholder:"js-operation-placeholder",zIndex:40,handle:".js-handle",stop:t.proxy(u,this)}),o.operations.on("change",".js-select-selection-type",t.proxy(f,this)),o.operations.on("click",".js-delete-operation",t.proxy(g,this)),o.operations.on("change keyup","input,select",t.proxy(u,this)),o.operations.on("change",".js-apply-to",t.proxy(u,this)),o.operations.on("change",".js-add-action",t.proxy(p,this)),o.operations.on("click",".js-delete-action",t.proxy(c,this)),o.operations.on("click",".js-help-date-formats",t.proxy(l,this))},l=function(e){i.emit("help_date_formats")},p=function(e){var n=t(e.currentTarget),i=n.closest(".js-operation"),o=t(s[n.val()]);n.val(""),i.find(".js-actions").append(o).sortable("refresh"),i.find(".js-no-action").hide(),u.apply(this)},c=function(e){var n=t(e.currentTarget),i=n.closest(".js-operation");n.closest(".js-action").remove(),i.find(".js-no-action").toggle(0===i.find(".js-action").length),u.apply(this)},u=function(){for(var e=[],t=o.operations.get(0).childNodes,n=0;n<t.length;n+=1){for(var s=t[n],r=s.querySelectorAll(".js-action"),a=[],l=0;l<r.length;l+=1)a.push(d(r[l]));e.push({selection:d.apply(this,[s.querySelector(".js-current-selection-fields")]),actions:a,applyTo:s.querySelector(".js-apply-to").value})}i.emit("edit_operations",e)},d=function(e){for(var t={type:e.getAttribute("rel"),options:{}},n=e.querySelectorAll('input[type="text"],input[type="radio"]:checked,input[type="hidden"],input[type="checkbox"]'),i=0;i<n.length;i+=1){var o=n[i];t.options[o.getAttribute("name")]="checkbox"===o.getAttribute("type")?o.checked:o.value}return t},f=function(e){var n=t(e.currentTarget),i=n.closest(".js-operation");i.find(".js-selection-fields").hide().removeClass("js-current-selection-fields"),i.find('.js-selection-fields[rel="'+n.val()+'"]').show().addClass("js-current-selection-fields")},h=function(e){e.preventDefault();var i=t(n);o.operations.append(i),o.operations.sortable("refresh"),i.find(".js-selection-fields").hide(),i.find(".js-actions").sortable({items:".js-action",placeholder:"js-action-placeholder",handle:".js-action-handle",axis:"y",containment:i,stop:t.proxy(u,this)}),i.find(".js-select-selection-type").trigger("change"),o.placeholder.hide()},g=function(e){e.preventDefault(),t(e.currentTarget).closest(".js-operation").remove(),o.operations.sortable("refresh"),o.placeholder.toggle(0===o.operations.children().length),u()},m=function(e){e.preventDefault(),i.emit("apply_operations")}};e.views.operations=n}(window.App,jQuery),function(e,t){"use strict";var n=function(){var n=new e.views.main,i=new e.models.main;this.init=function(){n.on("close",t.proxy(w,this)),n.on("loaded",t.proxy(o,this)),n.show()};var o=function(){i.on("progress",t.proxy(v),this),i.on("idle",t.proxy(y),this),i.on("add_files",t.proxy(g),this),i.on("added_files",t.proxy(m),this),i.on("remove_files",t.proxy(d),this),i.on("update_files",t.proxy(f),this),n.files.on("add_files",t.proxy(p,this)),n.files.on("remove_files",t.proxy(c,this)),n.files.on("set_destination",t.proxy(l),this),n.files.on("cancel",t.proxy(s),this),n.files.on("overwrite",t.proxy(r),this),n.operations.on("edit_operations",t.proxy(h,this)),n.operations.on("apply_operations",t.proxy(a,this)),n.operations.on("help_date_formats",t.proxy(u,this))},s=function(){i.cancelCurrentWork()},r=function(e,t){"dismiss"===e&&i.dismissOverwriteFiles(t),"overwrite"===e&&(n.files.lockInterface(!0),n.operations.lockInterface(!0),i.applyOperationsOnFiles(t,!1,!0))},a=function(){if(i.hasFiles()){var e=i.getDefaultDestinationDir();n.files.getDestinationDir(e)}},l=function(e){n.files.lockInterface(!0),n.operations.lockInterface(!0),i.applyOperationsOnFiles(!0,e,!1)},p=function(e){n.files.lockInterface(!0),n.operations.lockInterface(!0),i.addFiles(e)},c=function(e){i.removeFiles(e)},u=function(){e.openDateFormatsHelp()},d=function(e){n.files.removeFiles(e)},f=function(e){n.files.updateFiles(e,!1)},h=function(e){i.storeOperations(e),i.processCurrentOperations()},g=function(e){n.files.updateFiles(e,!0)},m=function(){i.processCurrentOperations()},v=function(e){n.files.setProgress(e)},y=function(){n.files.lockInterface(!1),n.operations.lockInterface(!1)},w=function(){i.cancelCurrentWork(),n.close()}};e.controllers.main=n}(window.App,jQuery);